<div class="cover-user-show">
  <div class="container d-flex flex-column align-items-center">
     <div class="row mt-5">
        <% if user_signed_in? && @user == current_user %>
           <h1 class="font-weight-normal">マイページ</h1>
        <% else %>
           <h1 class="font-weight-normal"><%= @user.name %>さんのページ</h1>
        <% end %>
     </div>
     <% if user_signed_in? && @user == current_user %>
        <p class="d-flex align-self-end">
           <%= link_to "プロフィール編集", edit_user_path(@user), class: "btn btn-success" %>
        </p>
     <% end %>
     <% if current_user !=@user %>
        <% if current_user.following?(@user) %>
           <p class="d-flex align-self-end">
              <%= link_to 'フォローを外す', user_relationships_path(@user.id), data: { turbo_method: :delete }, class: "btn btn-danger" %>
           </p>
           <% else %>
           <p class="d-flex align-self-end">
              <%= link_to 'フォローする', user_relationships_path(@user.id), data: { turbo_method: :post },  class:"btn btn-success" %>
           </p>
        <% end %>
     <% end %>
     <div class="d-flex w-100">
        <% if @user.profile_image.attached? %>
           <%= image_tag @user.profile_image, size: '100x100', class: "mb-3 profile_imag" %>
        <% else %>
           <%= image_tag "no-image.png", size: '100x100', class: "mb-3 profile-img" %>
        <% end %>
        <h4 class="ml-3 mb-3 card w-100 profile"><%= @user.profile %></h4>
     </div> 
     <div class="d-flex">
        <%= link_to follows_user_path(@user) do %>
            <h6>フォロー<%= @following_users.count %></h6>
        <% end %>
        <%= link_to followers_user_path(@user) do %>
            <h6>フォロワー<%= @follower_users.count %></h6>
        <% end %>
     </div>
     <% if @is_mutual_follow %>
       <!-- DMフォームを表示 -->
       <%= form_with(model: @message, url: room_messages_path(@room), local: true) do |f| %>
         <%= f.hidden_field :room_id, value: @room_id %>
         <%= f.text_area :message, placeholder: "メッセージを入力..." %>
         <%= f.submit "送信" %>
       <% end %>
     <% else %>
         <p>相互フォローしている場合のみメッセージを送信できます。</p>
     <% end %>
     <div class="row mt-5 index-left w-100">
        <% @records.each do |record| %>
          <div class="one-record col-sm-3 mb-3">
            <%= link_to record_path(record) do %>
                <% if record.photo.attached? %>
                   <%= image_tag record.photo.variant(resize_to_limit: [200, 133]) %>
                <% end %>
                <p class="caption mb-0"><%= record.event_name%></p>
                <p class="caption"><%= "#{record.comments.count} コメント" %></p>
            <% end %>
          </div>
        <% end %>
     </div>
     <%= paginate @records %>
  </div>
</div>
